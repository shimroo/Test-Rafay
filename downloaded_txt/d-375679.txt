!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalthis?globalthis:e||self).version={})}(this,(function(exports){"use strict";function __awaiter(e,t,n,i){return new(n||(n=promise))((function(s,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function r(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))}var blocking;"function"==typeof suppressederror&&suppressederror,function(e){e.pending="pending",e.none="none",e.blocked="blocked",e.allowed="allowed"}(blocking||(blocking={}));class adblock{constructor(e){this.state=blocking.pending,this._mocked=!1,e?(this.state=e,this._mocked=!0):this.state=blocking.allowed}inject(){return __awaiter(this,void 0,void 0,(function*(){}))}hasadblocker(){if(void 0===window.google)return!0;const e=document.queryselectorall("style");return array.from(e).some((e=>!!e.innerhtml.includes("adblockkey")))}handleadblocked(){this.removeadblockkey(),this.state=blocking.blocked}removeadblockkey(){var e;null===(e=document.documentelement.dataset)||void 0===e||delete e.adblockkey}get isblocked(){return this.state===blocking.blocked}get isallowed(){return this.state===blocking.allowed}tocontext(){return{user_has_ad_blocker:null,is_ad_blocked:null}}}const obfuscating_base_64_prefix="uxfdvmwnfnwn0wzodeybv",encode=e=>obfuscating_base_64_prefix+btoa(unescape(encodeuricomponent(json.stringify(e))));function decode$1(e){return json.parse(decodeuricomponent(escape(atob(e.replace(obfuscating_base_64_prefix,"")))))}var version="0.6.1";const app_env="production",tracking_domain="https://click-euw1.bodis.com/",sales_js_url="https://parking.bodiscdn.com/js/inquiry.js",google_caf_timeout_scripts="0",google_caf_timeout_callbacks="0",google_mv3_url_params="abp=1&bodis=true",app_version=version,cookie_consent_js_url="",islocal=(e=!0)=>"production"!==app_env;function log(...e){}const find_domain_url="_fd",getfinddomain=(e="",t=!1)=>{const n=`${e}/${find_domain_url}${window.location.search}`,i=e?"include":"same-origin",s=object.assign({accept:"application/json","content-type":"application/json"},t?{"x-host":window.location.host}:{});return fetch(n,{method:"post",headers:s,credentials:i}).then((e=>e.text())).then(decode$1)};var zeroclickreasons;!function(e){e.caf_timedout="caf_timedout",e.caf_adload_fail_rs="caf_adloadfail_rs",e.caf_adload_fail_ads="caf_adloadfail_ads",e.disabled_gb="disabled_gb",e.disabled_ab="disabled_ab",e.disabled_ds="disabled_ds",e.ad_blocked="ad_blocked",e.preferred="preferred"}(zeroclickreasons||(zeroclickreasons={}));const getzeroclick=e=>__awaiter(void 0,void 0,void 0,(function*(){const t=object.assign(object.assign({},e),{type:"zc_fetch"});return fetch("/_zc",{method:"post",body:json.stringify({signature:encode(t)}),headers:{accept:"application/json","content-type":"application/json"}}).then((e=>__awaiter(void 0,void 0,void 0,(function*(){try{return decode$1(yield e.text())}catch(e){return{}}}))))})),waiter=(e,t)=>new promise((n=>{t(e),e<=0&&n();let i=e;const s=()=>{i>0?(i-=1,t(i),settimeout(s,1e3)):n()};s()})),decode=()=>json.parse(atob(window.park||""));var page_styles='* {\n  font-smoothing: antialiased;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\nhtml, body {\n  width: 100%;\n  margin: 0;\n}\n\nhtml {\n  background-color: #2b2b2b;\n  height: 100%;\n}\n\nbody {\n  min-height: 90%;\n  font-family: arial, sans-serif;\n  letter-spacing: 1.2px;\n  color: #ccc;\n  text-align: center;\n}\n\n/* app target - this starts hidden until we apply a class to "activate" it */\n\n#target {\n  opacity: 0;\n  visibility: hidden;\n}\n\n/* status messages - these are displayed when we are not rendering ad blocks or related search */\n\n#pk-status-message {\n  height: 75vh;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n}\n\n/* sales box - default state */\n\n#sales-box {\n  display: block;\n  width: 100%;\n  padding: 3px;\n  text-align: center;\n  text-decoration: none;\n  color: #8eabc0;\n}\n\n#sales-box a {\n  display: block;\n  width: 100%;\n  text-decoration: inherit;\n  color: #8eabc0;\n  cursor: pointer;\n}\n\n/* sales box - highlighted state */\n\n#sales-box.is-highlighted {\n  position: relative;\n  z-index: 1;\n  background: #032438 linear-gradient(to top, #044368 0%, #000 100%);\n  box-shadow: 0 0 15px 0 #000;\n  border-bottom: 3px solid #262626;\n}\n\n#sales-box.is-highlighted a {\n  line-height: 1.3;\n  display: inline-block;\n  font-size: 18px;\n  color: #fff;\n  text-shadow: 1px 1px 0 rgba(0, 0, 0, 0.5);\n  background: none;\n}\n\n/* ellipsis loader */\n\n.pk-loader {\n  display: inline-block;\n  position: relative;\n  width: 80px;\n  height: 80px;\n}\n\n.pk-loader div {\n  position: absolute;\n  top: 33px;\n  width: 13px;\n  height: 13px;\n  border-radius: 50%;\n  background: #ccc;\n  animation-timing-function: cubic-bezier(0, 1, 1, 0);\n}\n\n.pk-loader div:nth-child(1) {\n  left: 8px;\n  animation: pk-anim-1 0.6s infinite;\n}\n\n.pk-loader div:nth-child(2) {\n  left: 8px;\n  animation: pk-anim-2 0.6s infinite;\n}\n\n.pk-loader div:nth-child(3) {\n  left: 32px;\n  animation: pk-anim-2 0.6s infinite;\n}\n\n.pk-loader div:nth-child(4) {\n  left: 56px;\n  animation: pk-anim-1 0.6s infinite;\n  animation-direction: reverse;\n}\n\n.pk-loader-text {\n  position: fixed;\n  font-size: 12px;\n  right: 20px;\n  bottom: 20px;\n  font-weight: lighter;\n}\n\n/* utilities */\n\n.pk-message-title {\n  font-size: 2em;\n  font-weight: bold;\n}\n\n.pk-page-ready {\n  opacity: 1 !important;\n  visibility: visible !important;\n}\n\n.hide-sales-banner > #sales-banner {\n    display: none;\n}\n\n@media only screen and (max-width: 600px) {\n  .hidden-xs {\n    opacity: 0;\n    visibility: hidden;\n  }\n}\n\n/* animation */\n\n@keyframes pk-anim-1 {\n  0% {\n      transform: scale(0);\n  }\n  100% {\n      transform: scale(1);\n  }\n}\n\n@keyframes pk-anim-2 {\n  0% {\n      transform: translate(0, 0);\n  }\n  100% {\n      transform: translate(24px, 0);\n  }\n}\n';const app_target="#target",message_target="main",message_selector="#pk-status-message",page_ready_class="pk-page-ready",message_template='';class renderer{constructor(e){this._domisready=!1,this.revealpage=()=>{this.domnode&&this.domnode.classlist.add(page_ready_class)},this.hidesalesbanner=()=>{this.domnode.classlist.add("hide-sales-banner")},this.revealsalesbanner=()=>{this.domnode.classlist.remove("hide-sales-banner")},this.injectmetadescription=e=>{if(!e||0===e.length)return;window.document.title=e;const t=document.createelement("meta");t.setattribute("name","description"),t.setattribute("content",`see relevant content for ${e}`),document.getelementsbytagname("head")[0].appendchild(t)},this.domnode=document.queryselector(e)}get domisready(){return this._domisready}set domisready(e){this._domisready=e,e&&this.injectstyles(page_styles)}message(e,t=""){if(this.injectmessage(message_template),this.domnode){const t=this.domnode.queryselector(message_selector);t&&(t.innerhtml=e)}t&&this.injectmetadescription(t)}injectmessage(e){const t=document.queryselector(message_target);t?t.innerhtml=e:this.domnode&&(this.domnode.innerhtml=e)}salesbanner(e){if(!e)return;const{href:t,position:n,message:i,theme:s,status:a}=e,o=document.createelement("div"),r=n||"",d="highlight"===s?"is-highlighted":"";o.innerhtml=t?`\n        \n          ${i}\n        \n      `:`\n        \n          ${i}\n        \n      `,"bottom"===n?(o.style.margintop="30px",document.body.appendchild(o)):document.body.prepend(o)}loading(e){let t="a few";e>0&&(t=`${e}`),this.message(`\n      \n        \n        \n        \n        \n      \n      \n        page loading in ${t} seconds, please wait...\n      \n    `)}adblockmessage(){this.message("\n      ad block detected\n      please disable your ad blocker and reload the page.\n    ")}errorparkingunavailable(){this.message("\n      an error occurred\n      parking is currently unavailable. we'll be right back.\n    ")}errorparkingservicesdisabled(){this.message("\n      an error occurred\n      services for this domain name have been disabled.\n    ")}errorparkingnosponsors(e){this.message(`\n      \n        no sponsors\n      \n      \n        ${window.location.hostname} currently does not have any sponsors for you.\n      \n    `,e)}imprint(e){if(!e)return;const t=document.queryselector("#imprint-text");t&&(t.innerhtml=e.replace(/(?:\r\n|\r|\n)/g,""))}injectstyles(e){if(!e)return;const t=document.createelement("style");t.innerhtml=e.tostring(),document.head.appendchild(t)}injectscript(e){if(!e)return;const t=document.createelement("script");t.type="text/javascript",t.src=e,document.body.appendchild(t)}injectjs(js){js&&0!==js.length&&eval(js)}injecthtml(e){this.domnode?(e&&(this.domnode.innerhtml=e),this.domisready=!0):(this.domisready=!1,console.error("an error occurred when trying to render this page. dom node not found."))}prerender(e){this.injectmetadescription(e.domain),e.banneradblockeronly&&this.hidesalesbanner(),this.injecthtml(e.html)}template(e){var t;this.domisready||this.prerender(e),this.injectstyles(e.stylesheet),this.imprint(e.imprint),this.salesbanner(e.salesbanner),e.banneradblockeronly||this.injectjs(e.javascript),null===(t=e.scripts)||void 0===t||t.foreach((e=>{this.injectscript(e)}))}}const render=new renderer(app_target);var type;!function(e){e[e.failed=0]="failed",e[e.disabled=1]="disabled",e[e.redirect=2]="redirect",e[e.parking=3]="parking",e[e.sales=4]="sales"}(type||(type={}));let state$2=class{get trackingtype(){return this._trackingtype}set trackingtype(e){this._trackingtype=e}get track(){return!!this.trackingtype}};class disabled extends state$2{constructor(){super(...arguments),this.type=type.disabled}static build(e,t){let n;switch(t===blocking.blocked&&(n="adblocker"),e.cannotpark){case"disabled_mr":case"disabled_rc":n=e.cannotpark}if(n){const t=new disabled;return t.reason=n,t.domain=e.domainname,t}}get message(){switch(this.reason){case"adblocker":return"content blocked please turn off your ad blocker.";case"disabled_mr":return`invalid url referral traffic for ${this.domain} does not meet requirements.`;default:return`no sponsors ${this.domain} currently does not have any sponsors for you.`}}get trackingtype(){switch(this.reason){case"adblocker":return"ad_blocked_message";case"disabled_mr":return"invalid_referral";case"disabled_rc":return"revenue_cap_reached";default:return"no_sponsors_message"}}tocontext(){return{cannotpark:this.reason}}}class failed extends state$2{constructor(){super(...arguments),this.type=type.failed}static cannotpark({cannotpark:e}){switch(e){case"disabled_b":case"prohibited_ua":case"disabled_fr":case"revenue_cap_reached":case"disabled_mr":case"disabled_rc":case"disabled_cp":case"invalid_domain":{const t=new failed;return t.reason=e,t}}}static nosponsors({cannotloadads:e}){if(e){const e=new failed;return e.reason="no_sponsors",e}}static fromerror(e){const t=new failed;return t.reason="js_error",t.error=e,t}get track(){return!!this.trackingtype}get message(){switch(this.reason){case"disabled_fr":case"disabled_rc":case"no_sponsors":return`\n          no sponsors\n          ${this.domain} currently does not have any sponsors for you.`;case"disabled_mr":return`\n          invalid url\n          referral traffic for ${this.domain} does not meet requirements.`;case"js_error":return"\n          an error occurred\n          parking is currently unavailable. we'll be right back.\n      ";default:return"\n          an error occurred\n          services for this domain name have been disabled.\n        "}}get trackingtype(){switch(this.reason){case"disabled_rc":return"revenue_cap_reached";case"disabled_mr":return"invalid_referral";case"adblock":return"ad_blocked_message";case"no_sponsors":return"no_sponsors_message"}}get domain(){return window.location.hostname}tocontext(){return{cannotpark:this.reason}}}function unpackphparrayobject(e,t){const n=e[t];if(n&&!array.isarray(n))return n}class parking extends state$2{constructor(){super(...arguments),this.type=type.parking}static build(e,t){const n=new parking;n.domain=e.domainname,n.html=e.template,n.scripts=e.scripts||[],n.javascript=e.inlinejs,n.stylesheet=e.styles,n.imprint=e.imprinttext;const i=unpackphparrayobject(e,"salessettings");n.banneradblockeronly=null==i?void 0:i.banner_adblocker_only;const s=(null==i?void 0:i.status)&&"not_for_sale"!==(null==i?void 0:i.status);if(s){const{status:e,location:t,message:s,link:a,type:o}=i;n.salesbanner={message:s,href:a,position:t,theme:o,status:e}}return t.wantstoserveads?n.trackingtype="ctr":s&&window.location.pathname.startswith("/listing")?n.trackingtype="sales":n.trackingtype="visit",n}tocontext(){return{}}}class sales extends state$2{constructor(){super(...arguments),this.type=type.sales}static build(e){const t=unpackphparrayobject(e,"salessettings");if(!t)return;const{status:n}=t;return["not_for_sale","external_market","url"].includes(n)?void 0:window.location.pathname.startswith("/listing")?new sales:void 0}tocontext(){return{}}get trackingtype(){return"sales"}init(e){window.context=e;const t=document.createelement("script");t.type="text/javascript",t.src=sales_js_url,document.head.append(t)}}class redirect extends state$2{constructor(){super(...arguments),this.type=type.redirect}static build(e,t,n){const i=unpackphparrayobject(e,"salessettings"),{zeroclickdelay:s,skenzoredirect:a,skenzourl:o,showinquiryform:r,canzeroclick:d,cannotpark:c}=e;if(window.location.pathname.startswith("/listing")&&["external_market","url"].includes(null==i?void 0:i.status)){if(null==i?void 0:i.external)return redirect.tostate(i.external,"sales");if(null==i?void 0:i.link)return redirect.tostate(i.link,"sales")}if(n.cannotloadads&&n.wantstoserveads)return redirect.tostate(n.noadsredirecturl,"no_ads_redirect");if(d&&(null==t?void 0:t.reason)){if(null==t?void 0:t.redirect)return redirect.tostate(t.redirect,"zc_redirect",s);if(a&&o)return redirect.tostate(o,"skenzo_redirect")}return(null==i?void 0:i.status)&&"not_for_sale"!==(null==i?void 0:i.status)&&!(null==i?void 0:i.banner_adblocker_only)&&(n.cannotloadads||n.cannotloadads&&!d||r)?redirect.tostate(`${window.location.origin}/listing`):void 0}static tostate(e,t,n=0){const i=new redirect;return i.url=e,i.delay=n,i.trackingtype=t,i}tocontext(){return{}}}const browserstate=()=>{var e,t,n,i,s;const{screen:{width:a,height:o},self:r,top:d,matchmedia:c,opener:l}=window,{documentelement:{clientwidth:h,clientheight:u}}=document;let p;try{p=(new date).gettimezoneoffset()/60*-1}catch(e){p=null}return{popup:!(!l||l===window),timezone_offset:p,user_preference:null===(e=null===intl||void 0===intl?void 0:intl.datetimeformat())||void 0===e?void 0:e.resolvedoptions(),user_using_darkmode:boolean(c&&c("(prefers-color-scheme: dark)").matches),user_supports_darkmode:boolean(c),window_resolution:{width:null!=h?h:0,height:null!=u?u:0},screen_resolution:{width:null!=a?a:0,height:null!=o?o:0},frame:d===r?null:{innerwidth:null!==(t=null==r?void 0:r.innerwidth)&&void 0!==t?t:0,innerheight:null!==(n=null==r?void 0:r.innerheight)&&void 0!==n?n:0,outerwidth:null!==(i=null==r?void 0:r.outerwidth)&&void 0!==i?i:0,outerheight:null!==(s=null==r?void 0:r.outerheight)&&void 0!==s?s:0}}},tracking_url="_tr",buildsignature=({callbacks:e,context:t},n)=>{var i,s,a,o;return object.assign({ad_loaded_callback:null==e?void 0:e.adloadedcallback,app_version:version,caf_client_id:null===(i=null==t?void 0:t.pageoptions)||void 0===i?void 0:i.pubid,caf_timed_out:null==e?void 0:e.caftimedout,caf_loaded_ms:null==e?void 0:e.cafloadedms,channel:null===(s=null==t?void 0:t.pageoptions)||void 0===s?void 0:s.channel,desktop:t.desktop,terms:null===(a=null==t?void 0:t.pageoptions)||void 0===a?void 0:a.terms,fd_server_datetime:t.fd_server_datetime,fd_server:t.fd_server,flex_rule:t.flex_rule,host:t.host,ip:t.ip,ivt:null===(o=null==t?void 0:t.pageoptions)||void 0===o?void 0:o.ivt,js_error:t.js_error,mobile:t.mobile,no_ads_redirect:t.noadsredirect,page_headers:t.page_headers,page_loaded_callback:null==e?void 0:e.pageloadedcallback,page_method:t.page_method,page_request:t.page_request,page_time:t.page_time,page_url:t.page_url,reportable_channel:t.reportablechannel,reportable_style_id:t.reportablestyleid,tablet:t.tablet,template_id:t.templateid,type:n,user_has_ad_blocker:t.user_has_ad_blocker,user_id:t.userid,uuid:t.uuid,zeroclick:t.zeroclick},browserstate())},trackvisit=({callbacks:e,context:t},n,i="")=>{const s=`${i}/${tracking_url}`,a=i?"include":"same-origin",o=buildsignature({callbacks:e,context:t},n);let r={};"click"===n&&(r={click:"true",session:t.uuid,nc:date.now().tostring()}),fetch(s,{method:"post",headers:{accept:"application/json","content-type":"application/json"},credentials:a,body:json.stringify(object.assign({signature:encode(o)},r))})};var state$1;!function(){if(!window.customevent){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};const n=document.createevent("customevent");return n.initcustomevent(e,t.bubbles,t.cancelable,t.detail),n}e.prototype=window.event.prototype,window.customevent=e}}(),function(e){e[e.pending=0]="pending",e[e.loaded=1]="loaded",e[e.failed=2]="failed"}(state$1||(state$1={}));class provider{constructor(e){this.timeoutseconds=5,this.handlepixelevent=e=>{switch(this.state){case state$1.failed:break;case state$1.pending:settimeout((()=>this.handlepixelevent(e)),100);break;case state$1.loaded:this.onpixelevent(e)}},this.watch=()=>{switch(this.state){case state$1.loaded:case state$1.failed:break;case state$1.pending:this.isloaded()?this.state=state$1.loaded:this.istimedout()?this.state=state$1.failed:settimeout(this.watch,50)}},this.config=e,this.identifier&&this.identifier.length>0?(this.state=state$1.pending,this.timeoutat=new date,this.timeoutat.setseconds(this.timeoutat.getseconds()+this.timeoutafter()),this.injectpixel()):this.state=state$1.failed}get identifier(){var e;return null===(e=this.config)||void 0===e?void 0:e.key}get pixelevents(){var e;return null===(e=this.config)||void 0===e?void 0:e.pixel_events}injectpixel(){this.injectedat||(this.injectedat=new date,this.inject(),this.watch())}inject(){const e=document.createelement("script");e.text=this.script,document.head.appendchild(e)}istimedout(){return+new date>=+this.timeoutat}timeoutafter(){return this.timeoutseconds}selectpixelevents(e){if(array.isarray(this.pixelevents))return this.pixelevents.filter((t=>"term-view"===t.trigger&&"visit"===e||(!(!["term-click","ad-view"].includes(t.trigger)||"ctr"!==e)||"ad-click"===t.trigger&&"click"===e)))}}class facebook extends provider{get script(){return`!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callmethod?n.callmethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createelement(e);t.async=!0;t.src=v;s=b.getelementsbytagname(e)[0];s.parentnode.insertbefore(t,s)}(window, document,'script','https://connect.facebook.net/en_us/fbevents.js');fbq('init', '${this.identifier}');`}onpixelevent(e){this.selectpixelevents(e).foreach((e=>{e&&(e.custom?window.fbq("trackcustom",e.event):window.fbq("track",e.event))}))}isloaded(){return!!window.fbq}}class outbrain extends provider{get script(){return`!function(_window, _document) {var ob_adv_id = '${this.identifier}';if (_window.obapi) {var toarray = function(object) {return object.prototype.tostring.call(object) === '[object array]' ? object : [object];};_window.obapi.marketerid = toarray(_window.obapi.marketerid).concat(toarray(ob_adv_id));return;}var api = _window.obapi = function() {api.dispatch ? api.dispatch.apply(api, arguments) : api.queue.push(arguments);};api.version = '1.1';api.loaded = true;api.marketerid = ob_adv_id;api.queue = [];var tag = _document.createelement('script');tag.async = true;tag.src = '//amplify.outbrain.com/cp/obtp.js';tag.type = 'text/javascript';var script = _document.getelementsbytagname('script')[0];script.parentnode.insertbefore(tag, script);}(window, document);`}onpixelevent(e){this.selectpixelevents(e).foreach((e=>{e&&window.obapi("track",e.event)}))}isloaded(){return!!window.obapi}}class revcontent extends provider{get script(){return""}inject(){const e=document.createelement("script");e.src="https://assets.revcontent.com/master/rev.js",document.head.appendchild(e)}onpixelevent(e){this.selectpixelevents(e).foreach((e=>{e&&window.rev("event",e.event)}))}isloaded(){return!!window.rev}}class taboola extends provider{get script(){return"window._tfa = window._tfa || [];!function (t, f, a, x) {if (!document.getelementbyid(x)) {t.async = 1;t.src = a;t.id=x;f.parentnode.insertbefore(t, f);}}(document.createelement('script'),document.getelementsbytagname('script')[0],'//cdn.taboola.com/libtrc/unip/1451879/tfa.js','tb_tfa_script');"}onpixelevent(e){this.selectpixelevents(e).foreach((e=>{e&&window._tfa.push({notify:"event",name:e.event,id:e.pixel_id})}))}isloaded(){return array.isarray(window._tfa)}}class tiktok extends provider{constructor(e,t){super(e),this.usealttiktokeventsforadsplatformuser=t}get script(){return`!function (w, d, t) {w.tiktokanalyticsobject=t;var ttq=w[t]=w[t]||[];ttq.methods=["page","track","identify","instances","debug","on","off","once","ready","alias","group","enablecookie","disablecookie"],ttq.setanddefer=function(t,e){t[e]=function(){t.push([e].concat(array.prototype.slice.call(arguments,0)))}};for(var i=0;i{e&&window.ttq.instance(this.identifier).track(e.event)}))}isloaded(){return!!window.ttq}}const ads_param$1="?caf",message_prefix="fsxdc,.acs:",allowed_origins=["https://www.google.com","https://www.adsensecustomsearchads.com","https://syndicatedsearch.goog","https://googleadservices.com"];class pixels{static build(e){const t=unpackphparrayobject(e,"pixel_tracking_data");if(t)return t.usealttiktokeventsforadsplatformuser=e.is_ads,new pixels(t)}constructor(e){this.onpixelevent=e=>{const{detail:{type:t}}=e;switch(t){case"visit":case"ctr":case"click":this.providers.foreach((e=>e.handlepixelevent(t)))}},this.providers=[new facebook(e.facebook),new tiktok(e.tiktok,e.usealttiktokeventsforadsplatformuser),new taboola(e.taboola),new revcontent(e.revcontent),new outbrain(e.outbrain)]}listenforevents(){document.addeventlistener("pixel",(e=>{this.onpixelevent(e)}));window.onmessage=e=>{const{origin:t,data:n}=e;allowed_origins.includes(t)&&(null==n?void 0:n.startswith(message_prefix))&&window.location.search.startswith(ads_param$1)&&document.dispatchevent(new customevent("pixel",{detail:{type:"click"}}))}}dispatchevent(e){document.dispatchevent(new customevent("pixel",{detail:e}))}}var state;!function(e){e[e.pending=0]="pending",e[e.loaded=1]="loaded",e[e.failure=2]="failure",e[e.timedout=3]="timedout",e[e.errored=4]="errored"}(state||(state={}));const caf_script_src=`https://www.google.com/adsense/domains/caf.js?${google_mv3_url_params}`,timeout_scripts=number(google_caf_timeout_scripts),timeout_callbacks=number(google_caf_timeout_callbacks);class statemachine{constructor(){this.state=state.pending}transitionto(e){this.state=e}transitionfrompendingto(e){this.done||(this.state=e)}get loaded(){return this.state===state.loaded}get timedout(){return this.state===state.timedout}get done(){return this.state!==state.pending}}class ads{constructor(e,t){this.state={script:new statemachine,blocks:new statemachine},this.blocksloaded=[],this.injectscripttags=()=>__awaiter(this,void 0,void 0,(function*(){return new promise((e=>{const t=document.createelement("script");t.type="text/javascript",t.src=caf_script_src,t.addeventlistener("load",(()=>e(!0))),t.addeventlistener("error",(()=>e(!1))),document.body.appendchild(t),timeout_scripts>0&&settimeout((()=>e(!1)),timeout_scripts)}))})),this.onpageloaded=(e,t)=>{if(this.pageloaded={requestaccepted:e,status:t},this.state.script.done)return;const n=null==t?void 0:t.error_code;n?(this.state.script.transitionto(state.failure),this.failurereason=`caf_pageloaderror_${n}`):this.state.script.transitionto(state.loaded)},this.onblockloaded=(e,t,n,i)=>{this.blocksloaded.push({containername:e,adsloaded:t,isexperimentvariant:n,callbackoptions:i}),this.state.blocks.done||(t?this.state.blocks.transitionto(state.loaded):this.blocksloaded.length>=this.blocks.length&&(this.state.blocks.transitionto(state.failure),this.failurereason=`caf_adloadfail_${e}`))},this.ontimeout=()=>{this.state.script.transitionfrompendingto(state.timedout),this.state.blocks.transitionfrompendingto(state.timedout)},this.blocks=e,this.options=t}get loaded(){return this.state.script.loaded&&!this.blocksloaded.map((e=>e.adsloaded)).includes(!1)}waitforblocks(){return __awaiter(this,void 0,void 0,(function*(){return new promise((e=>{const t=()=>{const n=performance.now();if(this.state.blocks.done)return this.cafloadtime=math.round(n-this.cafstarttime),void e();const i=this.blocksloaded.map((e=>e.adsloaded));i.includes(!1)||i.length>=this.blocks.length?e():settimeout(t,50)};t()}))}))}inject(){return __awaiter(this,void 0,void 0,(function*(){try{const e=yield this.injectscripttags();return this.cafstarttime=performance.now(),e&&void 0!==window.google?(new window.google.ads.domains.caf(object.assign(object.assign({},this.options),{pageloadedcallback:this.onpageloaded,adloadedcallback:this.onblockloaded}),...this.blocks),timeout_callbacks>0&&settimeout(this.ontimeout,timeout_callbacks),yield new promise((e=>{const t=()=>{this.state.script.done?e():settimeout(t,10)};t()}))):void this.state.script.transitionto(state.failure)}catch(e){return void(this.error=e.tostring())}}))}tocallbacks(){return{adloadedcallback:this.blocksloaded.slice(-1)[0],pageloadedcallback:this.pageloaded,caftimedout:this.state.script.timedout||this.state.blocks.timedout,cafloadedms:this.cafloadtime,googleadsfailure:!!this.failurereason}}tocontext(){const e={cafscriptwasloaded:this.state.script.loaded,cafscriptloadtime:this.cafloadtime,callbacks:this.tocallbacks};return this.error&&(e.js_error={message:this.error}),this.state.script.loaded||(e.zeroclick={reason:"googleadsfailure"}),e}mockfailedstate(){this.state.blocks.transitionto(state.failure),this.state.script.transitionto(state.failure)}}class tagmanager{constructor(e){this.injected=!1,this.identifier=e}inject(){if(this.injected)return;if(!this.identifier)return;if("test"===this.identifier)return;const e=document.createelement("script");e.setattribute("src",`https://www.googletagmanager.com/gtag/js?id=${this.identifier}`),document.head.appendchild(e),this.track(),this.injected=!0}track(){this.push("js",new date),this.push("config",this.identifier)}push(e,t){window.datalayer||(window.datalayer=[]),window.datalayer.push(arguments)}}const ads_param="caf",ads_tracking_url="_tr",blocks_type="ads",blocks_container="rs",known_caf_params=["caf","query","afdtoken","pcsa","nb","nm","nx","ny","is","clkt"];class google{static build({pageoptions:e,preferredlanguage:t,blocks:n,googleanalytics:i},s,a,o){let r={};e&&(r=object.assign({},e),r.hl||(r.hl=t));let d=null==e?void 0:e.resultspagebaseurl;d||(d=window.location.origin);return new google(s.uuid,n,r,i,d,o)}constructor(e,t,n,i,s,a){this._blocks=t,this._pageoptions=n,this.uuid=e,this._baseurl=new url(s),this._signature=a,this.ads=new ads(this.blocks,this.pageoptions),this.tagmanager=new tagmanager(i)}injecttagmanager(){this.tagmanager.inject()}injectads(){return __awaiter(this,void 0,void 0,(function*(){yield this.ads.inject()}))}waitforblocks(){return __awaiter(this,void 0,void 0,(function*(){return this.ads.waitforblocks()}))}get blocks(){return(this._blocks||[]).filter((e=>this.wantstoserveads?e.type===blocks_type:e.container===blocks_container)).map((e=>{const t=this.baseurl;new urlsearchparams(window.location.search).foreach(((e,n)=>{t.searchparams.has(n)||t.searchparams.append(n,e)}));const n=object.assign({},e);if(n.resultspagebaseurl=t.tostring(),this.wantstoserveads){const e=new urlsearchparams;e.append("click","true"),e.append("session",this.uuid);const t=object.assign({},this._signature);delete t.ad_loaded_callback,delete t.caf_loaded_ms,delete t.caf_timed_out,delete t.flex_rule,delete t.frame,delete t.js_error,delete t.no_ads_redirect,delete t.page_headers,delete t.page_request,delete t.page_loaded_callback,delete t.popup,delete t.screen_resolution,delete t.user_has_ad_blocker,delete t.user_preference,delete t.user_supports_darkmode,delete t.user_using_darkmode,delete t.zeroclick,e.append("signature",encode(t)),n.clicktrackurl=`${tracking_domain}${ads_tracking_url}?${e.tostring()}`}return n}))}get baseurl(){const e=new url(this._baseurl.origin);return e.searchparams.append(ads_param,"1"),this._baseurl.searchparams.foreach(((t,n)=>{e.searchparams.append(n,t)})),e}get pageoptions(){const e=object.assign({},this._pageoptions);return object.keys(this._pageoptions).foreach((t=>{t.startswith("bodis")&&delete e[t]})),e}get cannotloadads(){return!this.ads.loaded}get wantstoserveads(){return new urlsearchparams(window.location.search).has(ads_param)}get adsmode(){return this.ads.loaded&&this.wantstoserveads}get adsready(){return this.wantstoserveads&&!this.cannotloadads}get noadsredirecturl(){const e=new urlsearchparams(window.location.search);return known_caf_params.foreach((t=>e.delete(t))),`${window.location.origin}?${e.tostring()}`}get callbacks(){return this.ads.tocallbacks()}tocontext(){return object.assign({blocks:this.blocks,pageoptions:this.pageoptions},this.ads.tocontext())}}class cookieconsentmanager{constructor(){this.injectscripttag=()=>__awaiter(this,void 0,void 0,(function*(){return new promise((e=>{const t=document.createelement("script");t.setattribute("src",cookie_consent_js_url),t.addeventlistener("load",(()=>this.awaitconsent(e))),t.addeventlistener("error",(()=>e(!1))),document.head.appendchild(t)}))}))}inject(){return __awaiter(this,void 0,void 0,(function*(){this.injected||!cookie_consent_js_url||islocal()||(this.injected=yield this.injectscripttag())}))}awaitconsent(e){let t=0;const n=setinterval((()=>{t+=1,20===t&&(clearinterval(n),e(!0)),void 0!==window.__tcfapi&&(window.addeventlistener("consentactivity",(t=>{const{detail:{status:n}}=t;n&&e(!0)})),clearinterval(n))}),50)}}class app{main(){var e,t;return __awaiter(this,void 0,void 0,(function*(){if(this.parkresponse=decode(),this.finddomainresponse=yield getfinddomain(),!this.finddomainresponse)throw new error("domain failed to load.");this.pixels=pixels.build(this.finddomainresponse),null===(e=this.pixels)||void 0===e||e.listenforevents(),this.adblock=new adblock,yield this.adblock.inject(),this.google=google.build(this.finddomainresponse,this.parkresponse,this.adblock,buildsignature({context:this.context,callbacks:null===(t=this.google)||void 0===t?void 0:t.callbacks},"click")),this.google.injecttagmanager();const n=parking.build(this.finddomainresponse,this.google);render.prerender(n),this.cookieconsentmanager=new cookieconsentmanager,yield this.cookieconsentmanager.inject();let i=failed.cannotpark(this.finddomainresponse);if(i)return void(yield this.transitiontofailed(i,n));yield this.google.injectads();let s=disabled.build(this.finddomainresponse,this.adblock.state);if(s)return void(yield this.transitiontodisabled(s,n));const a=this.adblock.hasadblocker();a&&this.adblock.handleadblocked();const o=sales.build(this.finddomainresponse);if(o)return void(yield this.transitiontosales(o));this.eligibleforzeroclick&&(this.zeroclickresponse=yield getzeroclick(this.context));const r=redirect.build(this.finddomainresponse,this.zeroclickresponse,this.google);if(r)yield this.transitiontoredirect(r);else{if(a)return s=disabled.build(this.finddomainresponse,this.adblock.state),void(yield this.transitiontodisabled(s,n));i=failed.nosponsors(this.google),i?yield this.transitiontofailed(i,n):yield this.transitiontoparking(n)}}))}transitiontoparking(e){return __awaiter(this,void 0,void 0,(function*(){this.state=e,render.template(e),render.revealpage(),yield this.google.waitforblocks(),yield this.track()}))}transitiontoredirect(e){return __awaiter(this,void 0,void 0,(function*(){this.state=e;const t=this.track();render.revealpage(),yield waiter(e.delay,(e=>render.loading(e))),yield t,window.location.href=e.url,log(`➡ redirecting [${e.url}]`)}))}transitiontofailed(e,t){return __awaiter(this,void 0,void 0,(function*(){this.state=e,render.message(e.message),render.injectjs(t.javascript),render.revealpage(),yield this.track()}))}transitiontosales(e){return __awaiter(this,void 0,void 0,(function*(){this.state=e,e.init(this.context),yield this.track()}))}transitiontodisabled(e,t){return __awaiter(this,void 0,void 0,(function*(){this.state=e,render.message(e.message),render.injectjs(t.javascript),"adblocker"===e.reason&&t.banneradblockeronly&&render.revealsalesbanner(),render.revealpage(),yield this.track()}))}track(){var e;return __awaiter(this,void 0,void 0,(function*(){if(!this.state.track)return promise.resolve();try{const t=this.state.trackingtype;return null===(e=this.pixels)||void 0===e||e.dispatchevent({type:t}),trackvisit({context:this.context,callbacks:this.google.callbacks},t)}catch(e){return}}))}get eligibleforzeroclick(){const{cannotpark:e,canzeroclick:t,zeroclick:n}=this.finddomainresponse,{cannotloadads:i,wantstoserveads:s}=this.google;return this.adblock.state!==blocking.blocked&&(!!t&&(!!e||(!(!i||s)||!!(null==n?void 0:n.reason))))}get context(){var e,t,n,i;const s=this.finddomainresponse,a=this.parkresponse,o=null===(e=this.state)||void 0===e?void 0:e.tocontext(),r=null===(t=this.adblock)||void 0===t?void 0:t.tocontext(),d=null===(n=this.google)||void 0===n?void 0:n.tocontext(),c=browserstate(),l=object.assign(object.assign({},null===(i=this.finddomainresponse)||void 0===i?void 0:i.zeroclick),this.zeroclickresponse);return object.assign(object.assign(object.assign(object.assign(object.assign(object.assign(object.assign({app_version:app_version},s),a),r),d),o),c),{zeroclick:l})}init(){return __awaiter(this,void 0,void 0,(function*(){try{window.__parkour=this,yield this.main()}catch(e){console.error("app",e);const t=failed.fromerror(e);this.state=t,render.message(t.message),render.revealpage()}}))}}(new app).init(),exports.app=app}));
